<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Gerador de link com OG (V10)</title>
  <style>
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;margin:0;background:#0e1217;color:#eee}
    .wrap{display:grid;grid-template-columns:1fr 0.9fr;gap:18px;max-width:1100px;margin:20px auto;padding:16px}
    h1{font-size:18px;margin:0 0 12px}
    label{font-size:12px;opacity:.9}
    input,button{font-size:14px;padding:8px;border-radius:6px;border:1px solid #334;background:#141a22;color:#fff;width:100%}
    input[type=range]{width:100%}
    .row{display:grid;grid-template-columns:1fr 1fr;gap:10px}
    .btns{display:flex;gap:8px}
    .btns button{background:#2563eb;border:0;cursor:pointer}
    .small{font-size:12px;opacity:.8;margin-top:6px;word-break:break-all}
    .card{background:#111;border:1px solid #333;border-radius:8px;padding:10px}
    .preview{background:#000;border-radius:8px;overflow:hidden;aspect-ratio:1200/627;border:1px solid #333}
    .preview img{width:100%;height:100%;object-fit:cover;display:block}
  </style>
</head>
<body>
  <div class="wrap">
    <div>
      <h1>Produ√ß√£o r√°pida</h1>
      <div class="row">
        <div><label>Nome (no copo)</label><input id="n" value="Dennis"></div>
        <div><label>Cor (hex)</label><input id="co" value="3d352e"></div>
      </div>
      <div class="row">
        <div><label>T√≠tulo do card (OG)</label><input id="title" value="Convite especial para voc√™ üëã"></div>
        <div><label>Destino do clique</label><input id="dest" value="https://www.linkedin.com/in/marciomiranda/"></div>
      </div>
      <div><label>Descri√ß√£o (OG)</label><input id="desc" value="Acesso priorit√°rio por tempo limitado."></div>

      <div class="row">
        <div><label>Tamanho (fs)</label><input id="fs" type="range" min="16" max="48" value="26"></div>
        <div><label>Opacidade (0‚Äì100)</label><input id="o" type="range" min="0" max="100" value="65"></div>
      </div>
      <div class="row">
        <div><label>Posi√ß√£o X</label><input id="x" type="range" min="0" max="300" value="140"></div>
        <div><label>Posi√ß√£o Y</label><input id="y" type="range" min="0" max="300" value="50"></div>
      </div>
      <div class="row">
        <div><label>Blur</label><input id="blur" type="range" min="0" max="12" value="8"></div>
        <div><label>Cloudinary Base (opcional)</label><input id="base" placeholder="v1758136687/copo_qyzeoa.jpg"></div>
      </div>

      <div class="btns" style="margin-top:12px">
        <button id="copy">Copiar link curto</button>
        <button id="copymm">Copiar texto + link</button>
      </div>
      <div class="small">URL gerada: <span id="url"></span></div>
      <div class="small">Dica: rode 1x no <a style="color:#9cf" href="https://www.linkedin.com/post-inspector/" target="_blank">LinkedIn Post Inspector</a> e depois cole no inbox.</div>
    </div>

    <div class="card">
      <div class="preview"><img id="img" alt="preview"></div>
      <div class="small" id="hint"></div>
    </div>
  </div>

<script>
const cloud = "dr3r1szcw";
const pubDefault = "v1758136687/copo_qyzeoa.jpg";

function b64u(o){return btoa(unescape(encodeURIComponent(JSON.stringify(o)))).replace(/\+/g,'-').replace(/\//g,'_').replace(/=+$/,'');}

function buildImg(p){
  const name = encodeURIComponent((p.n||'').trim().slice(0,40));
  const fs = Number(p.fs||26);
  const x = Number(p.x||140), y=Number(p.y||50);
  const co = (p.co||'3d352e').replace(/[^0-9a-f]/gi,'').slice(0,6);
  const o = Math.max(0, Math.min(100, Number(p.o||65)));
  const blur = Math.max(0, Math.min(12, Number(p.blur||8)));
  const pub = (p.base && p.base.trim()) || pubDefault;
  // 1200x627 output
  const overlay = `l_text:Permanent%20Marker_${fs}:${name},co_rgb:${co},o_${o},e_blur:${blur}/fl_layer_apply,g_center,x_${x},y_${y}`;
  return `https://res.cloudinary.com/${cloud}/image/upload/c_fill,w_1200,h_627/${overlay}/${pub}`;
}

function readParams(){
  const p = {
    n:document.getElementById('n').value,
    fs:document.getElementById('fs').value,
    x:document.getElementById('x').value,
    y:document.getElementById('y').value,
    co:document.getElementById('co').value,
    o:document.getElementById('o').value,
    blur:document.getElementById('blur').value,
    title:document.getElementById('title').value,
    desc:document.getElementById('desc').value,
    dest:document.getElementById('dest').value,
    base:document.getElementById('base').value
  };
  return p;
}

function refresh(){
  const p = readParams();
  document.getElementById('img').src = buildImg(p);
  const token = b64u(p);
  const pretty = `${location.origin}/card/${token}`;
  document.getElementById('url').textContent = pretty;
  document.getElementById('hint').textContent = 'O card grande usar√° exatamente esta imagem como og:image (1200x627).';
}
for(const id of ['n','fs','x','y','co','o','blur','title','desc','dest','base']){
  document.getElementById(id).addEventListener('input', refresh);
}

document.getElementById('copy').onclick = async ()=>{
  refresh();
  await navigator.clipboard.writeText(document.getElementById('url').textContent);
  alert('Link curto copiado!');
};
document.getElementById('copymm').onclick = async ()=>{
  refresh();
  const url = document.getElementById('url').textContent;
  const n = document.getElementById('n').value || 'a√≠';
  const txt = `Oi, ${n}! D√° uma olhada üëá ${url}`;
  await navigator.clipboard.writeText(txt);
  alert('Texto + link copiados!');
};

refresh();
</script>
</body></html>
